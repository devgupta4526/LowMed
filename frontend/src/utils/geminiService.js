import { GoogleGenerativeAI } from "@google/generative-ai";

const apiKey = import.meta.env.VITE_GOOGLE_GEMINI_API_KEY;

const genAI = new GoogleGenerativeAI(apiKey);

const model = genAI.getGenerativeModel({
  model: "gemini-1.5-flash",
});

let BLOG_PROMPT =
  "Generate a Blog Post for Topic: {topic}. The blog post should be {wordCount} words long and should include the following sections: Introduction, Main Content, and Conclusion. The Main Content should be divided into {numberOfSections} sections with appropriate headings. Each section should provide detailed information, examples, and relevant images with correct source image URLs. The blog post should be engaging, informative, and optimized for SEO with appropriate keywords. Additionally, include a summary at the end and a call-to-action. The output should be in JSON format with keys: title, introduction, sections (an array of objects with heading and content), conclusion, summary, callToAction, and images (an array of objects with imageUrl and source).";

const generationConfig = {
  temperature: 1,
  topP: 0.95,
  topK: 64,
  maxOutputTokens: 8192,
  responseMimeType: "application/json",
};

export const generateBlogPost = async (topic, wordCount, section) => {
  const chatSession = model.startChat({
    generationConfig,
    history: [
      {
        role: "user",
        parts: [
          {
            text: "Generate a Blog Post for Topic: 'The Future of Web Development'. The blog post should be 1500 words long and should include the following sections: Introduction, Main Content, and Conclusion. The Main Content should be divided into 4 sections with appropriate headings: 'Introduction to Web Development', 'Latest Tools and Frameworks', 'Best Practices for Web Development', and 'Future Trends in Web Development'. Each section should provide detailed information, examples, and relevant images with correct source image URLs. The blog post should be engaging, informative, and optimized for SEO with appropriate keywords. Additionally, include a summary at the end and a call-to-action. The output should be in JSON format with keys: title, introduction, sections (an array of objects with heading and content), conclusion, summary, callToAction, and images (an array of objects with imageUrl and source).",
          },
        ],
      },
      {
        role: "model",
        parts: [
          {
            text: '```json\n{\n  "title": "The Future of Web Development: Trends, Tools, and Best Practices",\n  "introduction": "The world of web development is constantly evolving, driven by advancements in technology, user expectations, and the ever-changing landscape of the internet. From the rise of mobile-first experiences to the integration of artificial intelligence, the future of web development promises to be both exciting and challenging. This blog post will delve into the latest trends, tools, and best practices shaping the future of web development, empowering you to stay ahead of the curve.",\n  "sections": [\n    {\n      "heading": "Introduction to Web Development",\n      "content": "Web development encompasses the creation and maintenance of websites and web applications. It involves a wide range of skills, including programming languages like HTML, CSS, and JavaScript, as well as frameworks, libraries, and tools that streamline the development process. The goal of web development is to create user-friendly and engaging experiences that meet specific business needs and user requirements. Web developers play a crucial role in shaping the online world, building websites for e-commerce, social media, content management, and a myriad of other purposes.\\n\\n**Key Aspects of Web Development:**\\n\\n* **Front-end development:** This focuses on the user interface (UI) and user experience (UX), creating the visual elements that users interact with, such as layouts, navigation, and interactive components. Popular front-end technologies include HTML, CSS, JavaScript, React, Angular, and Vue.js.\\n* **Back-end development:** This deals with the server-side logic, data storage, and database management, ensuring the website functions correctly and securely. Back-end technologies include Node.js, Python, Java, Ruby on Rails, and PHP.\\n* **Full-stack development:** This combines both front-end and back-end skills, allowing developers to build complete web applications from start to finish."\n    },\n    {\n      "heading": "Latest Tools and Frameworks",\n      "content": "The web development landscape is constantly evolving, with new tools and frameworks emerging regularly to enhance efficiency and functionality. Here are some of the latest technologies that are shaping the future of web development:\\n\\n* **JavaScript Frameworks:**\\n    * **React:** Developed by Facebook, React is a popular JavaScript library for building user interfaces, known for its component-based architecture and virtual DOM. [Image: React logo](https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/React-icon.svg/1200px-React-icon.svg.png)\\n    * **Angular:** Developed by Google, Angular is a comprehensive JavaScript framework for building complex web applications, emphasizing modularity and testability. [Image: Angular logo](https://upload.wikimedia.org/wikipedia/commons/thumb/c/c3/Angular_logo.svg/1200px-Angular_logo.svg.png)\\n    * **Vue.js:** A progressive JavaScript framework known for its simplicity and ease of learning, Vue.js is becoming increasingly popular for building user interfaces and single-page applications. [Image: Vue.js logo](https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Vue.js_Logo_2.svg/1200px-Vue.js_Logo_2.svg.png)\\n* **Static Site Generators:**\\n    * **Next.js:** A React framework that allows developers to build performant, server-side rendered websites with features like automatic code splitting and pre-rendering for SEO optimization. [Image: Next.js logo](https://upload.wikimedia.org/wikipedia/commons/thumb/f/f5/Next.js_logo.svg/1200px-Next.js_logo.svg.png)\\n    * **Gatsby:** A React-based static site generator known for its speed, scalability, and developer-friendly features. [Image: Gatsby logo](https://upload.wikimedia.org/wikipedia/commons/thumb/e/e5/Gatsby_Logo.svg/1200px-Gatsby_Logo.svg.png)\\n* **Headless CMS:**\\n    * **Strapi:** An open-source headless CMS that allows developers to manage content and integrate it seamlessly with their front-end applications. [Image: Strapi logo](https://upload.wikimedia.org/wikipedia/commons/thumb/4/47/Strapi_Logo.svg/1200px-Strapi_Logo.svg.png)\\n    * **Contentful:** A cloud-based headless CMS offering a flexible content management platform with robust APIs for integration with various applications. [Image: Contentful logo](https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Contentful_logo.svg/1200px-Contentful_logo.svg.png)\\n* **Other Tools:**\\n    * **Webpack:** A module bundler that helps manage and optimize JavaScript, CSS, and other assets for web applications.\\n    * **Babel:** A JavaScript compiler that transforms modern JavaScript code into versions compatible with older browsers.\\n    * **GitHub:** A popular platform for version control and collaboration, allowing developers to track changes, manage code, and work together on projects.\\nThese tools and frameworks offer a wide range of capabilities to enhance the development process, making it more efficient, scalable, and adaptable to evolving trends."\n    },\n    {\n      "heading": "Best Practices for Web Development",\n      "content": "Following best practices in web development ensures the creation of high-quality, secure, and performant websites and applications. Here are some key best practices to consider:\\n\\n* **Accessibility:** Designing websites that are accessible to all users, including people with disabilities, is crucial. This involves following accessibility guidelines, using semantic HTML, and providing alternative text for images.\\n* **Security:** Protecting users\' data and ensuring website security is paramount. This involves implementing secure coding practices, using HTTPS encryption, and regularly updating software and plugins.\\n* **Performance:** Optimizing website performance is essential for user satisfaction and SEO. This involves minimizing file sizes, using caching, and optimizing images.\\n* **User Experience (UX):** Designing for a positive user experience is crucial. This involves creating intuitive navigation, clear calls to action, and a user-friendly layout. [Image: User experience design](https://www.freepik.com/free-vector/user-experience-ux-design-process-flowchart-diagram-with-user-icon-laptop-and-mobile-phone-symbols-modern-flat-vector-illustration_10580887.htm#query=user%20experience%20design&position=3&from_view=search)\\n* **Mobile Responsiveness:** Ensuring websites are optimized for mobile devices is essential, as mobile browsing continues to increase. This involves using responsive design techniques, testing on different devices, and ensuring the website functions correctly on mobile screens. [Image: Mobile responsiveness](https://www.freepik.com/free-vector/hand-holding-smartphone-with-responsive-web-design-concept_11393111.htm#query=mobile%20responsiveness&position=2&from_view=search)\\n* **Code Quality:** Writing clean, well-documented, and maintainable code is essential. This involves following coding standards, using meaningful variable names, and writing unit tests.\\n* **Version Control:** Using version control systems like Git allows developers to track changes, revert to previous versions, and collaborate effectively on projects.\\n* **Testing:** Thorough testing is essential to ensure websites function correctly and meet user expectations. This involves unit testing, integration testing, and user acceptance testing."\n    },\n    {\n      "heading": "Future Trends in Web Development",\n      "content": "The future of web development is exciting and filled with possibilities. Here are some key trends that are likely to shape the industry in the coming years:\\n\\n* **Artificial Intelligence (AI):** AI is revolutionizing web development, enabling personalized experiences, intelligent chatbots, and predictive analytics. [Image: AI chatbot](https://www.freepik.com/free-vector/online-chatbot-concept-illustration_11061317.htm#query=ai%20chatbot&position=1&from_view=search)\\n* **Progressive Web Apps (PWAs):** PWAs bridge the gap between websites and native apps, offering app-like functionality with the flexibility of a website. They are fast, responsive, and work offline, providing a seamless user experience.\\n* **Internet of Things (IoT):** The growing adoption of IoT devices will create new opportunities for web development, enabling interaction between websites and connected devices.\\n* **Serverless Computing:** Serverless computing allows developers to focus on writing code without worrying about managing servers, reducing costs and improving scalability.\\n* **Blockchain Technology:** Blockchain is becoming increasingly relevant in web development, enabling secure transactions, data storage, and decentralized applications.\\n* **Virtual and Augmented Reality (VR/AR):** VR and AR technologies are poised to change the way we interact with websites, creating immersive experiences and enhancing user engagement.\\n* **Voice Search Optimization:** As voice search becomes more popular, optimizing websites for voice queries will be crucial. This involves understanding natural language processing and optimizing content for voice search engines.\\n* **Cybersecurity:** With increasing threats to online security, cybersecurity will be a top priority. This involves implementing best practices, using secure coding techniques, and staying informed about emerging threats.\\n* **Sustainability:** Sustainable web development practices, such as reducing energy consumption and minimizing environmental impact, will become increasingly important.\\nBy staying informed about these trends and embracing new technologies, web developers can prepare for the future and contribute to the evolution of the internet."\n    }\n  ],\n  "conclusion": "The future of web development is a dynamic landscape, filled with opportunities for innovation and advancement. By staying informed about the latest tools, frameworks, and best practices, web developers can build websites and applications that are secure, performant, accessible, and engaging. Embracing emerging technologies like AI, PWAs, and blockchain will be crucial to creating the next generation of web experiences. As the internet continues to evolve, web development will play a vital role in shaping the future of how we connect, interact, and experience the digital world.",\n  "summary": "This blog post explored the evolving landscape of web development, covering key aspects, latest tools and frameworks, best practices, and future trends. It highlighted the importance of staying informed about emerging technologies and adapting to the changing needs of users. The post emphasized the role of web developers in shaping the future of the internet and the importance of creating accessible, secure, and performant websites and applications.",\n  "callToAction": "Are you ready to embrace the future of web development? Explore the resources mentioned in this blog post and start building your skills today! Join the conversation and share your thoughts on the trends shaping the web development industry.",\n  "images": [\n    {\n      "imageUrl": "https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/React-icon.svg/1200px-React-icon.svg.png",\n      "source": "Wikimedia Commons"\n    },\n    {\n      "imageUrl": "https://upload.wikimedia.org/wikipedia/commons/thumb/c/c3/Angular_logo.svg/1200px-Angular_logo.svg.png",\n      "source": "Wikimedia Commons"\n    },\n    {\n      "imageUrl": "https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Vue.js_Logo_2.svg/1200px-Vue.js_Logo_2.svg.png",\n      "source": "Wikimedia Commons"\n    },\n    {\n      "imageUrl": "https://upload.wikimedia.org/wikipedia/commons/thumb/f/f5/Next.js_logo.svg/1200px-Next.js_logo.svg.png",\n      "source": "Wikimedia Commons"\n    },\n    {\n      "imageUrl": "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e5/Gatsby_Logo.svg/1200px-Gatsby_Logo.svg.png",\n      "source": "Wikimedia Commons"\n    },\n    {\n      "imageUrl": "https://upload.wikimedia.org/wikipedia/commons/thumb/4/47/Strapi_Logo.svg/1200px-Strapi_Logo.svg.png",\n      "source": "Wikimedia Commons"\n    },\n    {\n      "imageUrl": "https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Contentful_logo.svg/1200px-Contentful_logo.svg.png",\n      "source": "Wikimedia Commons"\n    },\n    {\n      "imageUrl": "https://www.freepik.com/free-vector/user-experience-ux-design-process-flowchart-diagram-with-user-icon-laptop-and-mobile-phone-symbols-modern-flat-vector-illustration_10580887.htm#query=user%20experience%20design&position=3&from_view=search",\n      "source": "Freepik"\n    },\n    {\n      "imageUrl": "https://www.freepik.com/free-vector/hand-holding-smartphone-with-responsive-web-design-concept_11393111.htm#query=mobile%20responsiveness&position=2&from_view=search",\n      "source": "Freepik"\n    },\n    {\n      "imageUrl": "https://www.freepik.com/free-vector/online-chatbot-concept-illustration_11061317.htm#query=ai%20chatbot&position=1&from_view=search",\n      "source": "Freepik"\n    }\n  ]\n}\n```',
          },
        ],
      },
    ],
  });
  const prompt = BLOG_PROMPT.replace("{topic}", topic).replace("{numberOfSections}", section).replace(
    "{wordCount}",
    wordCount
  );
  const result = await chatSession.sendMessage(prompt);
  console.log("Fetched gemini data");
  const blogResp = JSON.parse(result.response.text());
  return blogResp;
};
